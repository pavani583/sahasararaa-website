<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>SAHASARARAA</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<style>
  :root{--primary:#006400;--gold:#D4AF37;--muted:#666}
  body{font-family:Inter,Arial,Helvetica,sans-serif;margin:0;background:#fff;color:#111}
  header{background:var(--primary);color:#fff;padding:12px 18px;display:flex;align-items:center;justify-content:space-between;position:relative}
  header h1{margin:0;font-size:20px}
  a{color:inherit;text-decoration:none}
  .container{max-width:1100px;margin:18px auto;padding:0 12px}
  .grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fill,minmax(240px,1fr))}
  .card{border:1px solid #eee;border-radius:8px;padding:10px;background:#fafafa}
  img{max-width:100%;border-radius:6px}
  .btn{background:var(--primary);color:#fff;border:none;padding:8px 10px;border-radius:6px;cursor:pointer}
  input,select,textarea{padding:8px;border-radius:6px;border:1px solid #ddd;width:100%;box-sizing:border-box;margin:6px 0}
  .muted{color:var(--muted)}
  .flex{display:flex;gap:8px;align-items:center}

  /* Hamburger styles */
  .hamburger{display:none;flex-direction:column;cursor:pointer;gap:4px}
  .hamburger div{width:25px;height:3px;background:#fff;border-radius:2px}
  nav.menu{position:absolute;top:60px;right:12px;background:#006400;color:#fff;border:1px solid #333;border-radius:6px;display:none;flex-direction:column;padding:12px;gap:8px;z-index:1000}
  nav.menu a{color:#fff;display:block}
  @media(max-width:768px){
    nav.menu{display:none;flex-direction:column}
    .hamburger{display:flex}
  }

  /* Hero slider */
  .hero-slider{position:relative;width:100%;height:300px;margin-bottom:20px;overflow:hidden;border-radius:8px}
  .hero-slide{width:100%;height:100%;position:absolute;top:0;left:0;transition:opacity 0.5s ease-in-out;opacity:0}
  .hero-slide.active{opacity:1}

  /* Category blocks */
  .categories{display:flex;gap:12px;margin-bottom:20px}
  .category-card{flex:1;position:relative;border-radius:8px;overflow:hidden;cursor:pointer}
  .category-card img{width:100%;height:150px;object-fit:cover}
  .category-card span{position:absolute;bottom:8px;left:8px;color:#fff;background:var(--gold);padding:4px 8px;border-radius:4px;font-weight:bold}

  /* Trending products section */
  .section-title{background:var(--primary);color:#fff;padding:8px 12px;border-radius:6px;margin-bottom:12px}
</style>
</head>
<body>
<header>
  <div style="display:flex;align-items:center;gap:12px">
    <img src="/images/SASRS_logo.png" alt="Sahasrara Logo" style="height:50px;">
    <h1>SAHASARARAA</h1>
  </div>
  <div class="hamburger" id="hamburger">
    <div></div><div></div><div></div>
  </div>
  <nav class="menu" id="menu">
    <a href="#" id="link-home">Home</a>
    <a href="#" id="link-cart">Cart (<span id="cart-count">0</span>)</a>
    <a href="#" id="link-orders">Orders</a>
    <a href="#" id="link-auth">Login/Register</a>
    <a href="/admin.html">Admin</a>
  </nav>
</header>
<div id="root" class="container"></div>

<script>
  const e = React.createElement;
  const API = '/api';
  window.appState = { token: localStorage.getItem('token'), user: localStorage.getItem('user') ? JSON.parse(localStorage.getItem('user')) : null };

  function setAuth(token,user){
    if(token) localStorage.setItem('token',token); else localStorage.removeItem('token');
    if(user) localStorage.setItem('user',JSON.stringify(user)); else localStorage.removeItem('user');
    window.appState.token=token; window.appState.user=user; updateHeader();
  }

  function updateHeader(){
    const welcome=document.getElementById('header-welcome');
    const authLink=document.getElementById('link-auth');
    if(window.appState.user){ welcome.textContent='Hi, '+window.appState.user.name; authLink.textContent='Logout'; }
    else{ welcome.textContent=''; authLink.textContent='Login/Register'; }
    fetchCartCount();
  }

  // Hamburger toggle
  const hamburger=document.getElementById('hamburger');
  const menu=document.getElementById('menu');
  hamburger.addEventListener('click',()=>{ menu.style.display=menu.style.display==='flex'?'none':'flex'; });

  // Menu links
  document.getElementById('link-home').addEventListener('click', ev=>{ ev.preventDefault(); renderApp(); });
  document.getElementById('link-cart').addEventListener('click', ev=>{ ev.preventDefault(); renderCart(); });
  document.getElementById('link-orders').addEventListener('click', ev=>{ ev.preventDefault(); renderOrders(); });
  document.getElementById('link-auth').addEventListener('click', ev=>{ ev.preventDefault(); if(window.appState.user){ setAuth(null,null); alert('Logged out'); renderApp(); } else renderAuth(); });

  function fetchCartCount(){
    const el=document.getElementById('cart-count');
    if(!window.appState.token){ el.textContent='0'; return; }
    fetch(API+'/cart',{headers:{'Authorization':'Bearer '+window.appState.token}}).then(r=>r.json()).then(data=>{
      const n=data.items?data.items.reduce((s,i)=>s+i.qty,0):0; el.textContent=n;
    }).catch(()=>el.textContent='0');
  }

  function renderApp(){
    const container=document.getElementById('root');
    container.innerHTML=`
      <div class="hero-slider" id="hero-slider"></div>
      <div class="categories">
        <div class="category-card" onclick="filterCategory('Men')"><img src="https://via.placeholder.com/400x150?text=Men"/><span>Men</span></div>
        <div class="category-card" onclick="filterCategory('Women')"><img src="https://via.placeholder.com/400x150?text=Women"/><span>Women</span></div>
        <div class="category-card" onclick="filterCategory('Kids')"><img src="https://via.placeholder.com/400x150?text=Kids"/><span>Kids</span></div>
      </div>
      <h3 class="section-title">Trending Products</h3>
      <div id="list" class="grid"></div>
    `;
    loadHeroSlider();
    loadTrending();
  }

  function loadHeroSlider(){
    const slides=[
      'https://via.placeholder.com/1100x300?text=Slide+1',
      'https://via.placeholder.com/1100x300?text=Slide+2',
      'https://via.placeholder.com/1100x300?text=Slide+3'
    ];
    const slider=document.getElementById('hero-slider');
    slider.innerHTML='';
    slides.forEach((src,i)=>{
      const img=document.createElement('img');
      img.src=src; img.className='hero-slide'; if(i===0) img.classList.add('active');
      slider.appendChild(img);
    });
    let index=0;
    setInterval(()=>{
      const imgs=document.querySelectorAll('.hero-slide');
      imgs.forEach(img=>img.classList.remove('active'));
      index=(index+1)%imgs.length;
      imgs[index].classList.add('active');
    },3000);
  }

  function loadTrending(){
    fetch(API+'/products').then(r=>r.json()).then(list=>{
      const wrap=document.getElementById('list'); wrap.innerHTML='';
      list.slice(0,6).forEach(p=>{
        const card=document.createElement('div'); card.className='card';
        card.innerHTML=`
          <img src="${(p.images&&p.images[0])?p.images[0]:'https://via.placeholder.com/500x350?text='+encodeURIComponent(p.name)}" />
          <h3>${p.name}</h3>
          <div class="muted">₹${p.price}</div>
          <div class="muted small">${p.desc||''}</div>
          <div style="margin-top:8px" class="flex">
            <button class="btn" onclick="viewProduct('${p.id}')">View</button>
            <button class="btn" onclick="addToCart('${p.id}',1)" style="background:#333">Add to Cart</button>
          </div>
        `;
        wrap.appendChild(card);
      });
    });
  }

  window.filterCategory=function(cat){
    fetch(API+'/products?category='+encodeURIComponent(cat)).then(r=>r.json()).then(list=>{
      const wrap=document.getElementById('list'); wrap.innerHTML='';
      list.forEach(p=>{
        const card=document.createElement('div'); card.className='card';
        card.innerHTML=`
          <img src="${(p.images&&p.images[0])?p.images[0]:'https://via.placeholder.com/500x350?text='+encodeURIComponent(p.name)}" />
          <h3>${p.name}</h3>
          <div class="muted">₹${p.price}</div>
          <div class="muted small">${p.desc||''}</div>
          <div style="margin-top:8px" class="flex">
            <button class="btn" onclick="viewProduct('${p.id}')">View</button>
            <button class="btn" onclick="addToCart('${p.id}',1)" style="background:#333">Add to Cart</button>
          </div>
        `;
        wrap.appendChild(card);
      });
    });
  }

  // Existing functions for viewProduct, addToCart, buyNow, renderCart, removeCart, renderCheckout, renderOrders, renderAuth
  // ... Keep all previous functions as-is from your existing code ...

  // Init
  updateHeader();
  renderApp();
</script>
</body>
</html>
