<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>SAHASR ARA — Admin</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --primary: #6a2ecc;
      --accent:  #ff7aa2;
      --bg: #f6f5fb;
      --card: #fff;
      --muted: #6b6b6b;
      --radius: 12px;
    }
    body{margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);color:#111;padding:12px}
    header{background:linear-gradient(90deg,var(--primary),#5633b1);color:#fff;padding:12px;border-radius:10px}
    header h1{margin:0;font-size:18px}
    .wrap{max-width:980px;margin:18px auto}
    .panel{background:var(--card);padding:14px;border-radius:12px;border:1px solid #eee;margin-bottom:12px}
    input,textarea,select{width:100%;padding:10px;border-radius:10px;border:1px solid #eae7f5;margin-top:8px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
    .card{background:#faf9ff;padding:10px;border-radius:10px;border:1px solid #f0eefb;display:flex;gap:10px;align-items:flex-start}
    .card img{width:90px;height:100px;object-fit:cover;border-radius:8px}
    .btn{padding:10px;border-radius:10px;border:none;cursor:pointer}
    .btn.primary{background:var(--primary);color:#fff}
    .btn.warn{background:#d11a2a;color:#fff}
    .muted{color:var(--muted)}
    @media (max-width:720px){
      .card{flex-direction:row;align-items:center}
      .card img{width:80px;height:80px}
    }
  </style>
</head>
<body>
  <header>
    <h1>SAHASR ARA — Admin Panel</h1>
  </header>

  <main class="wrap">
    <div id="admin-gate" class="panel">
      <div style="font-weight:700">Admin Access</div>
      <div class="muted" style="margin-top:6px">Enter admin secret to manage products (local testing).</div>
      <input id="admin-secret" placeholder="Enter admin secret" />
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="btnUnlock" class="btn primary">Unlock</button>
        <button id="btnSeed" class="btn" title="Restore sample seed">Seed Sample Products</button>
      </div>
      <div class="muted" style="margin-top:8px">Admin secret for testing: <b>sahasrara_admin_2025</b></div>
    </div>

    <div id="admin-area" style="display:none">
      <div class="panel">
        <h3 style="margin:0 0 8px 0">Add New Product</h3>
        <input id="title" placeholder="Product title (e.g. Elegant Silk Saree)" />
        <input id="price" placeholder="Price (number)" />
        <input id="image" placeholder="Image URL (first image shown)" />
        <input id="category" placeholder="Category (Silk, Cotton...)" />
        <input id="color" placeholder="Color (e.g. Maroon)" />
        <textarea id="description" placeholder="Description" rows="3"></textarea>
        <div style="display:flex;gap:8px;margin-top:10px">
          <button class="btn primary" id="btnAdd">Add Product</button>
          <button class="btn" id="btnExport">Export JSON</button>
        </div>
      </div>

      <div class="panel">
        <h3 style="margin:0 0 8px 0">Existing Products</h3>
        <div id="productList" class="grid"></div>
      </div>
    </div>

    <div id="message" style="display:none" class="panel"></div>
  </main>

  <script>
    /* Admin uses same storage keys as index.html */
    const KEY_PRODUCTS = 'sahasrara_products_v1';

    // admin secret (for testing)
    const ADMIN_SECRET = 'sahasrara_admin_2025';

    // get / set helpers
    function getProducts(){ try{ return JSON.parse(localStorage.getItem(KEY_PRODUCTS) || '[]') } catch(e){ return [] } }
    function setProducts(list){ localStorage.setItem(KEY_PRODUCTS, JSON.stringify(list)); }

    // seed (same sample as index for parity)
    function seed(){
      const sample = [
        { id: 'p1', name: 'Elegant Kanchipuram Silk Saree', price: 3999, images: ['https://images.unsplash.com/photo-1600180758895-1b66b8b3b6e6?q=80&w=1200&auto=format&fit=crop&ixlib=rb-4.0.3&s=7b674b2b5206f7b14ebf1a8a2d6bfe3c'], desc: 'Traditional Kanchipuram silk with rich border', category: 'Silk', color: 'Maroon' },
        { id: 'p2', name: 'Banarasi Heritage Saree', price: 4599, images: ['https://images.unsplash.com/photo-1562158070-1f6a9b1f3bfc?q=80&w=1200&auto=format&fit=crop&ixlib=rb-4.0.3&s=b6be4d6f2b0f1b9f168a4d9fd2ec8b6e'], desc: 'Banarasi weaving with gold thread', category: 'Banarasi', color: 'Gold' },
        { id: 'p3', name: 'Soft Cotton Everyday Saree', price: 1299, images: ['https://images.unsplash.com/photo-1543168256-78c1a440f6ce?q=80&w=1200&auto=format&fit=crop&ixlib=rb-4.0.3&s=5d7b6f8c0a9f4db4c2f6d1c8e0a219a0'], desc: 'Comfortable cotton for daily wear', category: 'Cotton', color: 'Blue' },
        { id: 'p4', name: 'Pattu Festive Saree', price: 2999, images: ['https://images.unsplash.com/photo-1520975916374-0f5d1a2b6f8a?q=80&w=1200&auto=format&fit=crop&ixlib=rb-4.0.3&s=0d3bf2e7a6e1f3d5c9b7f4a2d1a6d7c8'], desc: 'Pattu saree with bright hues', category: 'Pattu', color: 'Pink' }
      ];
      setProducts(sample);
      showMessage('Seeded sample products (4 items)', 2500);
      renderList();
    }

    // UI helpers
    function showMessage(txt= '', ms=2000){
      const el = document.getElementById('message');
      el.style.display='block'; el.innerHTML = txt;
      setTimeout(()=>{ el.style.display='none'; }, ms);
    }

    // admin unlock
    document.getElementById('btnUnlock').addEventListener('click', ()=>{
      const val = document.getElementById('admin-secret').value.trim();
      if (val === ADMIN_SECRET){
        document.getElementById('admin-gate').style.display='none';
        document.getElementById('admin-area').style.display='block';
        renderList();
        showMessage('Admin unlocked');
      } else {
        alert('Invalid secret');
      }
    });

    // seed button
    document.getElementById('btnSeed').addEventListener('click', ()=>{ if(confirm('Replace products with sample seed?')) seed(); });

    // add product
    document.getElementById('btnAdd').addEventListener('click', ()=>{
      const title = document.getElementById('title').value.trim();
      const price = Number(document.getElementById('price').value.trim());
      const image = document.getElementById('image').value.trim();
      const category = document.getElementById('category').value.trim();
      const color = document.getElementById('color').value.trim();
      const desc = document.getElementById('description').value.trim();
      if (!title || !price) return alert('Title and price required');
      const products = getProducts();
      const id = 'p' + Date.now();
      products.unshift({ id, name: title, price, images: image ? [image] : [], desc, category, color });
      setProducts(products);
      showMessage('Product added');
      // clear inputs
      document.getElementById('title').value='';document.getElementById('price').value='';document.getElementById('image').value='';document.getElementById('description').value='';
      renderList();
    });

    // render product list
    function renderList(){
      const wrap = document.getElementById('productList');
      const products = getProducts();
      wrap.innerHTML = '';
      if (!products.length) { wrap.innerHTML = '<div class="muted">No products</div>'; return; }
      products.forEach(p=>{
        const div = document.createElement('div'); div.className='card';
        div.innerHTML = `<img src="${p.images && p.images[0] ? p.images[0] : 'https://via.placeholder.com/300x300?text=Image'}" alt="${p.name}">
          <div style="flex:1">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div style="font-weight:700">${p.name}</div>
              <div style="font-weight:700;color:var(--primary)">₹${p.price}</div>
            </div>
            <div class="muted">${p.category || ''} • ${p.color || ''}</div>
            <div style="margin-top:8px;display:flex;gap:8px">
              <button class="btn" onclick='editProduct("${p.id}")'>Edit</button>
              <button class="btn warn" onclick='deleteProduct("${p.id}")'>Delete</button>
            </div>
          </div>`;
        wrap.appendChild(div);
      });
    }

    // delete
    function deleteProduct(id){
      if (!confirm('Delete this product?')) return;
      let list = getProducts(); list = list.filter(p=>p.id !== id); setProducts(list); renderList(); showMessage('Deleted');
    }

    // edit (simple inline prompt)
    function editProduct(id){
      const products = getProducts();
      const p = products.find(x=>x.id===id);
      if (!p) return;
      const newTitle = prompt('Product title', p.name);
      if (newTitle === null) return;
      const newPrice = prompt('Price', p.price);
      if (newPrice === null) return;
      p.name = newTitle.trim() || p.name;
      p.price = Number(newPrice) || p.price;
      setProducts(products);
      showMessage('Updated');
      renderList();
    }

    // export json
    document.getElementById('btnExport').addEventListener('click', ()=>{
      const data = JSON.stringify(getProducts(), null, 2);
      const blob = new Blob([data], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'products.json'; a.click();
      URL.revokeObjectURL(url);
    });

    // initialize: if no products seed with sample
    (function init(){
      if (!localStorage.getItem(KEY_PRODUCTS)) {
        // keep seed but not overwrite if user already had products
        seed();
      } else {
        renderList();
      }
    })();
  </script>
</body>
</html>
